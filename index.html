<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Multi-Select Converter</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.0/xlsx.full.min.js"></script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 0;
            padding: 20px;
            background-color: #f5f5f5;
        }
        
        .container {
            display: grid;
            grid-template-columns: 2fr 1fr;
            gap: 20px;
            max-width: 1400px;
            margin: 0 auto;
        }
        
        .left-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .right-column {
            display: flex;
            flex-direction: column;
            gap: 20px;
        }
        
        .selection-area, .converter-area, .stock-lister {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        
        select {
            width: 100%;
            padding: 8px;
            margin-bottom: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
        }
        
        .selected-items {
            min-height: 100px;
            padding: 10px;
            background: #f9f9f9;
            border: 1px solid #ddd;
            border-radius: 4px;
            margin-top: 10px;
        }
        
        .selected-tag {
            display: inline-block;
            background: #e3f2fd;
            padding: 4px 8px;
            margin: 4px;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .delete-btn {
            margin-left: 6px;
            color: #666;
            cursor: pointer;
        }
        
        textarea {
            width: 100%;
            height: 200px;
            margin: 10px 0;
            padding: 8px;
            border: 1px solid #ddd;
            border-radius: 4px;
            resize: vertical;
        }
        
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 14px;
            margin-right: 10px;
            margin-bottom: 10px;
        }
        
        button:hover {
            background: #1976d2;
        }
        
        #log {
            margin-top: 20px;
            padding: 10px;
            background: #f5f5f5;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-family: monospace;
            font-size: 12px;
            white-space: pre-wrap;
        }

        .stock-input {
            width: 100%;
            padding: 12px;
            margin-bottom: 15px;
            border: 1px solid #ddd;
            border-radius: 4px;
            box-sizing: border-box;
            font-size: 16px;
        }

        .stock-list {
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .stock-item {
            background: #f8f9fa;
            padding: 12px 15px;
            margin-bottom: 8px;
            border-radius: 4px;
            border: 1px solid #e9ecef;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .button-group {
            display: flex;
            gap: 10px;
            margin-bottom: 15px;
        }

        .delete-button {
            background: #dc3545;
        }

        .delete-button:hover {
            background: #c82333;
        }

        .input-delete-button {
            background: #ffc107;
            color: #000;
        }

        .input-delete-button:hover {
            background: #e0a800;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="left-column">
            <!-- Stock Lister -->
            <div class="stock-lister">
                <h3>Stock Lister</h3>
                <input type="text" id="stockInput" class="stock-input" placeholder="Enter stock name and press Enter...">
                <div class="button-group">
                    <button class="input-delete-button" onclick="clearInput()">Clear Input</button>
                    <button class="delete-button" onclick="clearAll()">Clear All</button>
                </div>
                <ul id="stockList" class="stock-list"></ul>
            </div>

            <!-- JSON to Excel Converter -->
            <div class="converter-area">
                <h3>JSON to Excel Converter</h3>
                <textarea id="jsonInput" placeholder="Paste your numbered JSON data here..."></textarea>
                <button onclick="convertToExcel()">Convert to Excel</button>
                <div id="log"></div>
            </div>
        </div>

        <div class="right-column">
            <!-- Selection Area 1 -->
            <div class="selection-area">
                <h3>Business metrics</h3>
                <select multiple id="select1" size="8">
<option value="quarterly_sales">Quarterly Sales</option>
<option value="quarterly_opm">Quarterly OPM</option>
<option value="quarterly_pbt">Quarterly PBT</option>
<option value="quarterly_netprofit">Quarterly Net Profit</option>
<option value="quarterly_eps">Quarterly EPS</option>
<option value="yearly_sales">Yearly Sales</option>
<option value="yearly_opm">Yearly OPM</option>
<option value="yearly_pbt">Yearly PBT</option>
<option value="yearly_netprofit">Yearly Net Profit</option>
<option value="yearly_eps">Yearly EPS</option>
<option value="yearly_dividend">Yearly Dividend</option>
<option value="free_cash_flow">Free Cash Flow</option>
<option value="current_ratio">Current Ratio</option>
<option value="debt_to_equity_ratio">Debt to Equity Ratio</option>
<option value="roe">ROE</option>
<option value="pe_ratio">P/E Ratio</option>


                </select>
                <div class="selected-items" id="selected1"></div>
            </div>

            <!-- Selection Area 2 -->
            <div class="selection-area">
                <h3>Business metrics for Financial stocks</h3>
                <select multiple id="select2" size="8">
<option value="quarterly_revenue">Quarterly Revenue</option>
<option value="quarterly_opm">Quarterly OPM</option>
<option value="quarterly_pbt">Quarterly PBT</option>
<option value="quarterly_netprofit">Quarterly Net Profit</option>
<option value="quarterly_eps">Quarterly EPS</option>
<option value="yearly_revenue">Yearly Revenue</option>
<option value="yearly_opm">Yearly OPM</option>
<option value="yearly_pbt">Yearly PBT</option>
<option value="yearly_netprofit">Yearly Net Profit</option>
<option value="yearly_eps">Yearly EPS</option>
<option value="yearly_dividend">Yearly Dividend</option>
<option value="roe">ROE</option>
<option value="pe_ratio">PE Ratio</option>
                </select>
                <div class="selected-items" id="selected2"></div>
            </div>
        </div>
    </div>

    <script>
        // Selection area handlers
        function handleSelection(selectId, selectedId) {
            const select = document.getElementById(selectId);
            const selectedDiv = document.getElementById(selectedId);
            
            select.addEventListener('change', () => {
                selectedDiv.innerHTML = '';
                Array.from(select.selectedOptions).forEach(option => {
                    const tag = document.createElement('span');
                    tag.className = 'selected-tag';
                    tag.innerHTML = `${option.text} <span class="delete-btn" onclick="removeSelection('${selectId}', '${option.value}')">×</span>`;
                    selectedDiv.appendChild(tag);
                });
            });
        }

        function removeSelection(selectId, value) {
            const select = document.getElementById(selectId);
            const option = Array.from(select.options).find(opt => opt.value === value);
            if (option) option.selected = false;
            select.dispatchEvent(new Event('change'));
        }

        // Stock Lister functions
        function addStock(stockName) {
            const list = document.getElementById('stockList');
            const li = document.createElement('li');
            li.className = 'stock-item';
            li.innerHTML = `${stockName} <span class="delete-btn" onclick="this.parentElement.remove()">×</span>`;
            list.appendChild(li);
        }

        function clearInput() {
            document.getElementById('stockInput').value = '';
        }

        function clearAll() {
            document.getElementById('stockInput').value = '';
            document.getElementById('stockList').innerHTML = '';
        }

        // Enter key handler for stock input
        document.getElementById('stockInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter' && this.value.trim() !== '') {
                addStock(this.value.trim());
                this.value = '';
            }
        });

        // Initialize selection handlers
        handleSelection('select1', 'selected1');
        handleSelection('select2', 'selected2');

        // JSON to Excel conversion functions
        function log(message) {
            const logElement = document.getElementById('log');
            logElement.textContent += message + '\n';
            console.log(message);
        }

        // ... [rest of the conversion functions remain the same]
    </script>
</body>
</html>
